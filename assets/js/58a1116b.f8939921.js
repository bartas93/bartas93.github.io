"use strict";(self.webpackChunklearning_notes=self.webpackChunklearning_notes||[]).push([[6373],{44442:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var o=t(85893),a=t(11151);const i={title:"How to Setup a OpenVPN Server?",authors:"xiaohai",tags:["Docker","VPN"],image:"https://developers.redhat.com/sites/default/files/styles/article_feature/public/blog/2014/05/homepage-docker-logo.png?itok=zx0e-vcP",description:"Setup a OpenVPN server using Docker in just one command."},s=void 0,r={permalink:"/blog/2022/02/04/how-to-setup-an-openvpn-server",editUrl:"https://github.com/xiaohai-huang/learning-notes/tree/master/blog/2022/02-04-how-to-setup-an-openvpn-server/index.md",source:"@site/blog/2022/02-04-how-to-setup-an-openvpn-server/index.md",title:"How to Setup a OpenVPN Server?",description:"Setup a OpenVPN server using Docker in just one command.",date:"2022-02-04T00:00:00.000Z",formattedDate:"4 February 2022",tags:[{label:"Docker",permalink:"/blog/tags/docker"},{label:"VPN",permalink:"/blog/tags/vpn"}],readingTime:.725,hasTruncateMarker:!0,authors:[{name:"Xiaohai Huang",title:"CS Student",url:"http://github.com/xiaohai-huang",imageURL:"https://github.com/xiaohai-huang.png",key:"xiaohai"}],frontMatter:{title:"How to Setup a OpenVPN Server?",authors:"xiaohai",tags:["Docker","VPN"],image:"https://developers.redhat.com/sites/default/files/styles/article_feature/public/blog/2014/05/homepage-docker-logo.png?itok=zx0e-vcP",description:"Setup a OpenVPN server using Docker in just one command."},unlisted:!1,prevItem:{title:"CMD vs ENTRYPOINT",permalink:"/blog/2022/03/03/cmd-vs-entrypoint"},nextItem:{title:"Xiaohai's First Blog Post",permalink:"/blog/2022/01/20/first-blog"}},c={authorsImageUrls:[void 0]},l=[{value:"How to Backup VPN Data",id:"how-to-backup-vpn-data",level:2}];function p(e){const n=Object.assign({p:"p",pre:"pre",code:"code",a:"a",ul:"ul",li:"li",h2:"h2",strong:"strong",ol:"ol"},(0,a.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Just a simple command"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"docker run -itd --restart always --cap-add=NET_ADMIN \\\n           -p 1194:1194/udp -p 7070:8080/tcp \\\n           -e HOST_ADDR=$(curl -s https://api.ipify.org) \\\n           -v openvpn_conf:/opt/Dockovpn_data \\\n           --name dockovpn alekslitvinenk/openvpn\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Then download the config file from the ",(0,o.jsx)(n.code,{children:"http://<public-ip>:7070"})," and then import the config file (",(0,o.jsx)(n.code,{children:"client.ovpn"}),") to the ",(0,o.jsx)(n.a,{href:"https://openvpn.net/vpn-client/",children:"vpn client"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Clients:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://6669-first-cloudbase-env-5c619520c1a6-1255762420.tcb.qcloud.la/mind-storage/openvpn-connect-windows.msi",children:"Windows"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://6669-first-cloudbase-env-5c619520c1a6-1255762420.tcb.qcloud.la/mind-storage/oepnvpn-android.apk",children:"Android"})}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"how-to-backup-vpn-data",children:"How to Backup VPN Data"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.strong,{children:"VPN"})," container uses ",(0,o.jsx)(n.strong,{children:"named volume"})," to store configuration data.\nSo we can use the ",(0,o.jsx)(n.code,{children:"volume-backup"})," utility to backup data. ",(0,o.jsx)(n.a,{href:"https://github.com/loomchild/volume-backup",children:"https://github.com/loomchild/volume-backup"}),"."]}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Backup"}),". The following command will store the vpn data in ",(0,o.jsx)(n.code,{children:'"$(pwd)/vpn_config_data.tar.bz2"'}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",metastring:'title="backup.sh"',children:"docker run -v openvpn_conf:/volume \\\n           -v $(pwd):/backup --rm \\\n           loomchild/volume-backup backup vpn_config_data.tar.bz2\n"})}),"\n",(0,o.jsxs)(n.ol,{start:"2",children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Restore"}),". The following command will use ",(0,o.jsx)(n.code,{children:'"$(pwd)/vpn_config_data.tar.bz2"'})," to populate and override the volume named ",(0,o.jsx)(n.code,{children:"openvpn_conf"}),"."]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",metastring:'title="restore.sh"',children:"docker run -v openvpn_conf:/volume \\\n           -v $(pwd):/backup --rm \\\n           loomchild/volume-backup restore -f vpn_config_data # without extension\n"})})]})}const d=function(e={}){const{wrapper:n}=Object.assign({},(0,a.ah)(),e.components);return n?(0,o.jsx)(n,Object.assign({},e,{children:(0,o.jsx)(p,e)})):p(e)}},11151:(e,n,t)=>{t.d(n,{Zo:()=>r,ah:()=>i});var o=t(67294);const a=o.createContext({});function i(e){const n=o.useContext(a);return o.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const s={};function r({components:e,children:n,disableParentContext:t}){let r;return r=t?"function"==typeof e?e({}):e||s:i(e),o.createElement(a.Provider,{value:r},n)}}}]);