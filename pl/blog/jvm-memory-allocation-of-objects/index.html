<!doctype html>
<html lang="pl" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/pl/blog/rss.xml" title="Bartosz Jabłoński - IT Blog and Travel RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/pl/blog/atom.xml" title="Bartosz Jabłoński - IT Blog and Travel Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Bartosz Jabłoński - IT Blog and Travel" href="/pl/opensearch.xml">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-DZ5M330L5C"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-DZ5M330L5C",{})</script><title data-rh="true">Sprawdzenie dokładnej alokacji pamięci JVM - biblioteka jol (Java Object Layout) | Bartosz Jabłoński - IT Blog and Travel</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://bartas93.github.io/pl/blog/jvm-memory-allocation-of-objects"><meta data-rh="true" name="docusaurus_locale" content="pl"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="pl"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Sprawdzenie dokładnej alokacji pamięci JVM - biblioteka jol (Java Object Layout) | Bartosz Jabłoński - IT Blog and Travel"><meta data-rh="true" name="description" content="W skrócie"><meta data-rh="true" property="og:description" content="W skrócie"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-05-16T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://bartas93.github.io"><meta data-rh="true" property="article:tag" content="jvm,jol,heap,memory,references"><link data-rh="true" rel="icon" href="/pl/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://bartas93.github.io/pl/blog/jvm-memory-allocation-of-objects"><link data-rh="true" rel="alternate" href="https://bartas93.github.io/blog/jvm-memory-allocation-of-objects" hreflang="en"><link data-rh="true" rel="alternate" href="https://bartas93.github.io/pl/blog/jvm-memory-allocation-of-objects" hreflang="pl"><link data-rh="true" rel="alternate" href="https://bartas93.github.io/blog/jvm-memory-allocation-of-objects" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://M3DHZC040W-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/pl/assets/css/styles.b3db76c4.css">
<link rel="preload" href="/pl/assets/js/runtime~main.4813a504.js" as="script">
<link rel="preload" href="/pl/assets/js/main.b47291b4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Przejdź do głównej zawartości</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/pl/"><div class="navbar__logo"><img src="/pl/images/logo.svg" alt="Bartosz Jablonski Logo" class="themedImage_ToTc themedImage--light_HNdA" width="150"><img src="/pl/images/logo-white.svg" alt="Bartosz Jablonski Logo" class="themedImage_ToTc themedImage--dark_i4oU" width="150"></div></a><a class="navbar__item navbar__link" href="/pl/about">O mnie</a><a class="navbar__item navbar__link" href="/pl/docs/projects">Projekty</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/pl/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>Polski</a><ul class="dropdown__menu"><li><a href="/blog/jvm-memory-allocation-of-objects" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/pl/blog/jvm-memory-allocation-of-objects" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">Polski</a></li></ul></div><a href="https://gitlab.com/bart_as93/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Gitlab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Przełącz pomiędzy ciemnym a jasnym motywem (aktualnie ustawiony ciemny motyw)" aria-label="Przełącz pomiędzy ciemnym a jasnym motywem (aktualnie ustawiony ciemny motyw)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Szukaj"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Szukaj</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Nawigacja po najnowszych postach na blogu"><div class="sidebarItemTitle_pO2u margin-bottom--md">Wszystkie posty</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/pl/blog/jvm-memory-allocation-of-objects">Sprawdzenie dokładnej alokacji pamięci JVM - biblioteka jol (Java Object Layout)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pl/blog/regular-expressions">Wyrażenia regularne</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pl/blog/string-in-jvm-memory">Obliczanie pamięci zajmowanej przez String - JOL Footprint</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/pl/blog/python-youtube-downloader">Ściągaj Playlisty z YouTube bez reklam za darmo - za pomocą prostego skryptu</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Sprawdzenie dokładnej alokacji pamięci JVM - biblioteka jol (Java Object Layout)</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-05-16T00:00:00.000Z" itemprop="datePublished">16 maja 2024</time> · <!-- -->14 min aby przeczytać</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://bartas93.github.io" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="/images/bartek_jablonski_2.png" alt="Bartek Jabłoński"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://bartas93.github.io" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Bartek Jabłoński</span></a></div><small class="avatar__subtitle" itemprop="description">Backend Cloud Developer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="w-skrócie">W skrócie<a class="hash-link" href="#w-skrócie" title="Bezpośredni link do nagłówka">​</a></h2><ul><li>Każdy obiekt ma narzut pamięci (metadane) (12-16 bajtów na metadane - referencja, headery + pamięć na dane).</li><li>Procesory (CPU) mogą być 32 bitowe (4 byte - maxymalnie 4 GB pamięci RAM) lub 64 bitowe (8 byte). To oznacza tyle, że CPU ma dostęp do tyłu adresów ile można zapisać w 4 lub 8 bytach. Dodatkowo CPU pobiera paczkami dane z RAM po 8 bytów naraz.</li><li>Padding - wyrównanie do 8 bajtów - czyli obiekty zajmują pamięć równą wielokrotności 8 bajtów. Można to zwiększyć bo ogranicza to użycie maksymalnego heapa na poziomie 32 GB.</li><li>Referencja zajmuje 4 (32bit CPU lub 64bit CPU z Compressed References (default)) lub 8 bajtów (64bit CPU).<ul><li>Maksymalny heap dla Compressed References = 32 GB - wykorzystanie przesunięcia bitowego o 3 miejsca ze względu na to że zapis 8 byte zawsze po prawej stronie ma trzy zera. (8 byte bo jest wyrównanie do 8 bytów). Dlatego możemy użyć 32 GB heapa zamiast 4 GB.</li><li>Gdy używamy 64bit CPU z Compressed References i zwiększymy Pamięć heapa powyżej 32 GB możemy mieć problemy z aplikacją i znaczący wzrost zajmowanego heapa ze względu na zmianę pamięci referencji z 4 bytes do 8 bytes - np. zmiana z -Xmx31g do -Xmx33g może spowodować wzrost zajęcia danych o 40% (w zależności od danych)</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="konfiguracja">Konfiguracja<a class="hash-link" href="#konfiguracja" title="Bezpośredni link do nagłówka">​</a></h2><p>Aby sprawdzić jak wygląda układ pamięci (memory layout) użyjemy biblioteki:</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.openjdk.jol</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">jol-core</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">0.10</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Jol to taki toolbox do analizowania układu obiektów w JVM. Te narzędzia używają (w celu dekodowania rzeczywistego układu obiektu (object layout), jego zajmowanej pamięci (footprint) i referencji (references)). Jol używa takich narzędzi jak:</p><ul><li>Unsafe</li><li>JVMTI</li><li>Serviceability Agent (SA)</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dostępne-metody">Dostępne metody<a class="hash-link" href="#dostępne-metody" title="Bezpośredni link do nagłówka">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="detale-vm---vmcurrentdetails---podstawowe-dane-związane-z-naszą-jvm">Detale VM - <code>VM.current().details()</code> - Podstawowe dane związane z naszą JVM<a class="hash-link" href="#detale-vm---vmcurrentdetails---podstawowe-dane-związane-z-naszą-jvm" title="Bezpośredni link do nagłówka">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Running 64-bit HotSpot VM.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Using compressed oop with 3-bit shift.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Using compressed klass with 3-bit shift.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># WARNING | Compressed references base/shifts are guessed by the experiment!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># WARNING | Therefore, computed addresses are just guesses, and ARE NOT RELIABLE.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># WARNING | Make sure to attach Serviceability Agent to get the reliable addresses.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Objects are 8 bytes aligned.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Field sizes by type: 4, 1, 1, 2, 2, 4, 4, 8, 8 [bytes]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># Array element sizes: 4, 1, 1, 2, 2, 4, 4, 8, 8 [bytes]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li><p>Uruchamiamy nasz program na <strong>64</strong> bitowej wersji <strong>JVM – HotSpot</strong></p></li><li><p><code>Using compressed oop with 3-bit shift.</code> - <a href="#compressed-vs-uncompressed-references">więcej</a></p></li><li><p><code>Using compressed klass with 3-bit shift.</code> - <a href="#compressed-vs-uncompressed-references">więcej</a></p></li><li><p><code>Objects are 8 bytes aligned.</code> - Obiekty będą wyrównane do <strong>8</strong> bajtów - oznacza to tyle, że każdy obiekt nawet jak powinien zajmować 20 bytów to i tak zajmuje wielokrotność 8 bajtów czyli w tym przypadku 24 bajty. Zawsze idzie w górę do wielokrotności 8 bajtów.</p></li><li><p>Dlaczego?
Procesory są 32 lub 64 bitowe (32 bit CPU może użyć max 4 GB pamięci). Czyli 4 lub 8 bytowe. Co oznacza, że odczytują (z rejestru pamięci poprzez zewnętrzną magistralę) po 4 lub 8 bytów pamięci naraz. CPU nie pobiera pojedynczych bitów lub bytów. Pobiera paczkami. Jest to spowodowane tym że CPU (np. 3GHz) jest szybsze niż pamięć (400MHz). Wykorzystując to że CPU jest szybsze pobieramy paczkami dane. Aby ułatwić (i przyspieszyć) to wyciąganie danych, JVM grupuje te dane po 8 bytów dla 64 bitowej maszyny (czyli większość współczesnych).</p></li><li><p>Można to zmienić flagą JVM: <code>*-XX:ObjectAlignmentInBytes=16</code> (Dostępne wartości 8,16,32,64,128,256, inaczej JVM rzuci błąd i nie uruchomi aplikacji). Flaga, przez którą większość obiektów będzie zajmowało dużo więcej nieużytej pamięci. Zalętą tego rozwiązania jest że możemy wtedy użyć 64 GB Heap z skompresowanymi referencjami. (Ponieważ 3 bit shifting zmieni się na 4 bit shifting - 16 byte zawsze ma 4 zera po prawej stronie)*</p></li><li><p>Następnie są pokazane rozmiary typów w naszej JVM</p></li><li><p>Referencja obiektu: 4 bytes - w tym przypadku jest włączona domyślnie flaga Compressed References - dlatego w 64 bitowej JVM referencja zajmuje 4 bytes a nie tak jak powinien 8 bytes. Aby zajmowało 8 bytes to nalezy uruchomić JVM z flagą: <em><code>-XX:-UseCompressedOops</code></em></p><p>Dodatkowo należy pamiętać że 4 bytes to 32 bitów czyli 2^32 możliwych unikalnych adresów referencji do zapisania (przy compressed oops wykorzystywane jest przesunięcie o e bity co efektywnie daje nam aż 8 razy więcej możliwych adresów)</p></li><li><p>boolean i byte: 1 byte</p></li><li><p>short and char: 2bytes</p></li><li><p>int and float: 4 bytes</p></li><li><p>long and double 8 bytes</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="typy-określeń-zajmowanej-pamięci">Typy określeń zajmowanej pamięci:<a class="hash-link" href="#typy-określeń-zajmowanej-pamięci" title="Bezpośredni link do nagłówka">​</a></h2><ul><li>Shallow size - to co nam ClassLayout mówi</li><li>Deep size - to co nam footprint mówi</li><li>Retained size - to co zwalnia GC - np. te wielkości pokazywane są w heapdump</li></ul><p><img loading="lazy" alt="Typy plików" src="/pl/assets/images/size-types-0b6e945e9f03b350461559386c49bd83.png" width="904" height="393" class="img_ev3q"></p><p>Na powyższym przykładzie - Retained size to zwolniona pamięć po usunięciu referencji Triple - tylko Ai + Ci jest zwalniane a Bi jest używane przez Pair. Te dodatkowe referencje komplikują retained size. Retained size jest zawsze pomiędzy shallow a deep size.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="układ-klasy---classlayout-shallow-size">Układ klasy - ClassLayout (shallow size)<a class="hash-link" href="#układ-klasy---classlayout-shallow-size" title="Bezpośredni link do nagłówka">​</a></h3><p><code>ClassLayout.parseClass(Basket.class).toPrintable(b1))</code></p><p>Wszystkie obiekty przechowują dane typu podstawowego. Mają swój dodatkowy narzut pamięci (metadane). Układ klasy pokazuje nam ile bajtów zajmują headery, ile zajmują pola typu prostego danej klasy, ile zajmują referencje do innych pod obiektów (ale nie pokazuje ile pod obiekt zajmuje pamięci). Dodatkowo pokazuje przesunięcie (np. 4 bytes external) - czyli przesunięcie do 8 bajtów</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@Data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@AllArgsConstructor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">ExampleClass</span><span class="token plain"> b1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1232132</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">123</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ClassLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toPrintable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">com.example.demo.ExampleClass object internals:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> OFFSET  SIZE   TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      0     4        (object header)                           01 ed d3 b0 (00000001 11101101 11010011 10110000) (-1328288511)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      4     4        (object header)                           6f 00 00 00 (01101111 00000000 00000000 00000000) (111)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      8     4        (object header)                           78 f2 01 01 (01111000 11110010 00000001 00000001) (16904824)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     12     4    int ExampleClass.a                            1232132</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     16     4    int ExampleClass.b                            123</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     20     4        (loss due to the next object alignment)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Instance size: 24 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Space losses: 0 bytes internal + 4 bytes external = 4 bytes total</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="metadane"><strong>Metadane:</strong><a class="hash-link" href="#metadane" title="Bezpośredni link do nagłówka">​</a></h3><ul><li><p>headery:</p><ul><li><p>flagi (0→4 bajtów) (mark word)- przechowują informacje o stanie obiektu. Między innymi shape obiektu, czyli czy jest to klasa czy tablica oraz hash code oraz ilość przetrwań GC do promocji do OldGeneration- 4 bajty</p></li><li><p>lock (4→8 bajtów) (mark word) - monitor, który będzie wykorzystywany do mutexów - 4 bajty</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">Lock</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">Lock</span><span class="token plain"> lock </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">Lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Lock object internals:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> OFFSET  SIZE   TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      0     4        (object header)                           01 00 00 00 </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      4     4        (object header)                           00 **00** 00 00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      8     4        (object header)                           85 23 02 f8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     12     4        (loss due to the next object alignment)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Instance size: 16 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">synchronized</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ClassLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">lock</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toPrintable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Pierwszy header się zmienił ponieważ przeliczony został domyślny hashCode()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Drugi header się zmienił ze względu na lock!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Lock object internals:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> OFFSET  SIZE   TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      0     4        (object header)                           f0 78 12 03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      4     4        (object header)                           00 **70** 00 00</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      8     4        (object header)                           85 23 02 f8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     12     4        (loss due to the next object alignment)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>class (8→12 bajtów) (klass word)- wskaźnik do typu w naszym przypadku 4 bajty</p></li><li><p>size - rozmiar tablicy (wartość ta obecna jest tylko dla typów tablicowych) - w przykładzie powyżej tego nie ma (4 byte)</p></li></ul></li></ul><ul><li>Dane<ul><li>pola klasy - reszta bajtów w naszym przykładzie 2x4 bajty na pola int.</li></ul></li><li><ul><li>ewentualne przesunięcie do 8 bajtów (w naszym przypadku 4 bajty przesunięcia )</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="footprint-deep-size">Footprint (Deep size)<a class="hash-link" href="#footprint-deep-size" title="Bezpośredni link do nagłówka">​</a></h3><p>Jeśli mamy jakieś odniesienia do innych obiektów w naszym analizowanym obiekcie to ClassLayout pokaże tylko dodatkowe 4 bajty na referencję (Nie weźmie pod uwagę zawartości obiektu do którego się odnosimy) - w takim przypadku warto wykorzystać FootPrint który pokaże ile zajmuje pamięci cały obiekt razem z obiektem wewnątrz.</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@Data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@AllArgsConstructor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token class-name">InnerClass</span><span class="token plain"> d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@Data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@AllArgsConstructor</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">public</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">InnerClass</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> a</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">private</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> b</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">ExampleClass</span><span class="token class-name punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">InnerClass</span><span class="token plain"> inner </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token class-name punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">InnerClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">12</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">ExampleClass</span><span class="token plain"> b1 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1232132</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">123</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token number">111</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> inner</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">GraphLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toFootprint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ClassLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toPrintable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">b1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ClassLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ExampleClass</span><span class="token class-name punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">InnerClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toPrintable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">inner</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">### FOOTPRINT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name namespace">com</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">example</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">demo</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">ExampleClass</span><span class="token annotation punctuation" style="color:rgb(248, 248, 242)">@6dde5c8cd</span><span class="token plain"> footprint</span><span class="token operator">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     COUNT       AVG       SUM   DESCRIPTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token number">1</span><span class="token plain">        </span><span class="token number">32</span><span class="token plain">        </span><span class="token number">32</span><span class="token plain">   </span><span class="token class-name namespace">com</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">example</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">demo</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">ExampleClass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token number">1</span><span class="token plain">        </span><span class="token number">24</span><span class="token plain">        </span><span class="token number">24</span><span class="token plain">   </span><span class="token class-name namespace">com</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">example</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">demo</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">ExampleClass</span><span class="token plain">$</span><span class="token class-name">InnerClass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">         </span><span class="token number">2</span><span class="token plain">                  </span><span class="token number">56</span><span class="token plain">   </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">total</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">### CLASSLAYOUT</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name namespace">com</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">example</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">demo</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">ExampleClass</span><span class="token plain"> object internals</span><span class="token operator">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> OFFSET  SIZE                                       TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">                                            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                           </span><span class="token number">01</span><span class="token plain"> </span><span class="token number">8</span><span class="token plain">c </span><span class="token number">5</span><span class="token plain">c de </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">00000001</span><span class="token plain"> </span><span class="token number">10001100</span><span class="token plain"> </span><span class="token number">01011100</span><span class="token plain"> </span><span class="token number">11011110</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token operator">-</span><span class="token number">564360191</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">4</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">                                            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                           </span><span class="token number">6d</span><span class="token plain"> </span><span class="token number">00</span><span class="token plain"> </span><span class="token number">00</span><span class="token plain"> </span><span class="token number">00</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">01101101</span><span class="token plain"> </span><span class="token number">00000000</span><span class="token plain"> </span><span class="token number">00000000</span><span class="token plain"> </span><span class="token number">00000000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">109</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">8</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">                                            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                           a0 f4 </span><span class="token number">01</span><span class="token plain"> </span><span class="token number">01</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">10100000</span><span class="token plain"> </span><span class="token number">11110100</span><span class="token plain"> </span><span class="token number">00000001</span><span class="token plain"> </span><span class="token number">00000001</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">16905376</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">12</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">                                        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">a                            </span><span class="token number">1232132</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">16</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">                                        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">b                            </span><span class="token number">123</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">20</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">                                        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">c                            </span><span class="token number">111</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">24</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">   </span><span class="token class-name namespace">com</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">example</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">demo</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">ExampleClass</span><span class="token class-name punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">InnerClass</span><span class="token plain"> </span><span class="token class-name">ExampleClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">d                            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">28</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">                                            </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">loss due </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">to</span><span class="token plain"> </span><span class="token namespace">the</span><span class="token plain"> next object alignment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">Instance</span><span class="token plain"> size</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">32</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">Space</span><span class="token plain"> losses</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> bytes internal </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"> bytes external </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"> bytes total</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name namespace">com</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">example</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name namespace">demo</span><span class="token class-name namespace punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token class-name">ExampleClass</span><span class="token plain">$</span><span class="token class-name">InnerClass</span><span class="token plain"> object internals</span><span class="token operator">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> OFFSET  SIZE   TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">0</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                           </span><span class="token number">01</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain">b </span><span class="token number">3</span><span class="token plain">e </span><span class="token number">5</span><span class="token plain">b </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">00000001</span><span class="token plain"> </span><span class="token number">01011011</span><span class="token plain"> </span><span class="token number">00111110</span><span class="token plain"> </span><span class="token number">01011011</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1530813185</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">4</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                           </span><span class="token number">01</span><span class="token plain"> </span><span class="token number">00</span><span class="token plain"> </span><span class="token number">00</span><span class="token plain"> </span><span class="token number">00</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">00000001</span><span class="token plain"> </span><span class="token number">00000000</span><span class="token plain"> </span><span class="token number">00000000</span><span class="token plain"> </span><span class="token number">00000000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token number">8</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">object header</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain">                           </span><span class="token number">78</span><span class="token plain"> f2 </span><span class="token number">01</span><span class="token plain"> </span><span class="token number">01</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">01111000</span><span class="token plain"> </span><span class="token number">11110010</span><span class="token plain"> </span><span class="token number">00000001</span><span class="token plain"> </span><span class="token number">00000001</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">16904824</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">12</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token class-name">InnerClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">a                              </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">16</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token class-name">InnerClass</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">b                              </span><span class="token number">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     </span><span class="token number">20</span><span class="token plain">     </span><span class="token number">4</span><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">loss due </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">to</span><span class="token plain"> </span><span class="token namespace">the</span><span class="token plain"> next object alignment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">Instance</span><span class="token plain"> size</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">24</span><span class="token plain"> bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">Space</span><span class="token plain"> losses</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> bytes internal </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"> bytes external </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"> bytes total</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Powyżej mamy porównanie Footprint i ClassLayout. W Footprint widzimy dokładnie ile bajtów zajmuje obiekt z jego podobiektami (56 bajtów). A w ClassLayout widzimy tylko przegląd danej klasy bez pod obiektów (32 bytes i 24 bytes).</p><p>Rozbijmy footprint aby jeszcze bardziej było to zrozumiałe:</p><p>Na 56 bytes skłąda się:
ExampleClass: 12 bajtów na metadane + 3x 4 bajty na inta + 4 bajty na referencje = 28 bajtów
28 bajtów + 4bajtów (wyrównanie do 8 bajtów) = <strong>32 bajtów</strong>
InnerClass: 12 bajtów na metadane + 2x 4 bajty na inta = 20 bajtów - nie jest to wielokrotność 8 bajtów (wyrównanie) więc: 20 bajtów + 4 bajtów = 24 bajty.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="compressed-vs-uncompressed-references">Compressed vs Uncompressed References<a class="hash-link" href="#compressed-vs-uncompressed-references" title="Bezpośredni link do nagłówka">​</a></h3><p>Dzięki temu że jest wyrównanie do wielokrotności 8 byte, możemy wykorzystać pewną ciekawą własność jaką jest zapis takich liczb w formie binarnej. Wszystkie wielokrotności liczby 8 w formie binarnej kończą się minimum trzema zerami (z prawej strony). Znając tą prawidłowość programiści JVM wykorzystali tą własność tak że robią przesunięcie o 3 bity w prawo co powoduje że do zapisu adresów pamięci mamy dodatkowe 3 bity. Co zwiększa nam zakres z 2^32~4GB do 2^(32+3)~32GB. (8 razy więcej możliwych adresów)</p><p><strong>Dzięki temu pozwalamy na więcej niż 4 GB przestrzeni na stercie z referencjami 32-bitowymi na maszynach 64-bitowych!</strong></p><p><img loading="lazy" alt="Bit shifting" src="/pl/assets/images/bit-shifting-68ac0bba76cdaf64ccf1111856163eca.png" width="841" height="232" class="img_ev3q"></p><p>Domyślnie uruchomiona jest kompresja referencji. To oznacza tyle, że klass word zajmuje 4 bytów oraz każda referencja zajmuje 4 bytów. Takie ustawienia mają limit <strong>32 GB heapa.</strong> Gdy używamy więcej niż 32 GB heapa to automatycznie kompresja jest wyłączana. Ewentualnie możemy ręcznie wyłączyć kompresje referencji poprzez <em><code>-XX:-UseCompressedOops</code>- gdzie takie ustawienie wyłącza kompresowanie referencji i wtedy rozmiar referencji wynosi 8 bytów.</em></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="powyżej-32-gb">Powyżej 32 GB<a class="hash-link" href="#powyżej-32-gb" title="Bezpośredni link do nagłówka">​</a></h3><p>Jeśli chcemy użyć więcej niż 32 GB heapa i chcemy używać compressed reference:</p><p>Wzór na maxymalny heap size: 4GB * ObjectAlignmentInBytes. - ale należy pamiętać, że allignments wzrasta dla każdego istniejącego obiektu co w konsekwencji zwiększa rozmiar każdego obiektu. Nie zawsze się to opłaci.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="co-to-jest-paddingalligment-gap-internal-space-losses">Co to jest padding/alligment gap (internal space losses)<a class="hash-link" href="#co-to-jest-paddingalligment-gap-internal-space-losses" title="Bezpośredni link do nagłówka">​</a></h3><p>Dopełnienie bajtów do wielokrotności 8 bajtów może przyjąć 2 formy</p><ul><li>internal space losses</li><li>external space losses</li></ul><p>Procesor pobiera dane po 8 bytów naraz. Aby ułatwić pobieranie danych robimy przesunięcia. Przykład ułatwienia pobierania danych z internal space losses - dla łatwiejszego ukazania przykładu wykorzystano flagę JVM <em><code>-XX:ObjectAlignmentInBytes=16</code></em>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">SimpleLong object internals:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> OFFSET  SIZE   TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      0    12        (object header)                           N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     12     4        (alignment/padding gap)                  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     16     8   long SimpleLong.state                          N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     24     8        (loss due to the next object alignment)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Instance size: 32 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Space losses: 4 bytes internal + 8 bytes external = 12 bytes total</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Po 12 bajtach związanych z headerem dodany został internal aligment/padding gap = 4 bajty. tak aby wyciąganie longa było w jednym procesie CPU. (tak aby long variable było w offsecie 16)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="field-packing---upakowanie-pól">Field Packing - Upakowanie pól<a class="hash-link" href="#field-packing---upakowanie-pól" title="Bezpośredni link do nagłówka">​</a></h3><p>O kolejności upakowania pól w pamięci decyduje JVM a nie deklaracja pól w implementacji klasy. Jest to po to aby właśnie ułatwić kondensowanie wielokrotności 8 bajtów tak aby np. int nie był rozdzielony na 2 wyciągnięcia danych po 8 bajtów.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class FieldsArrangement {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private boolean first;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private char second;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private double third;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private int fourth;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    private boolean fifth;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OFFSET  SIZE      TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      0    12           (object header)                           N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     12     4       int FieldsArrangement.fourth                  N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     16     8    double FieldsArrangement.third                   N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     24     2      char FieldsArrangement.second                  N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     26     1   boolean FieldsArrangement.first                   N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     27     1   boolean FieldsArrangement.fifth                   N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     28     4           (loss due to the next object alignment)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="inne-przykłady---sprawdzanie-rozmiaru-pamięci-dla-obiektów">Inne przykłady - Sprawdzanie rozmiaru pamięci dla obiektów<a class="hash-link" href="#inne-przykłady---sprawdzanie-rozmiaru-pamięci-dla-obiektów" title="Bezpośredni link do nagłówka">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="array">Array:<a class="hash-link" href="#array" title="Bezpośredni link do nagłówka">​</a></h3><ul><li><p>Array booleanów</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">boolean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> booleans </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">boolean</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ClassLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">booleans</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toPrintable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">GraphLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">booleans</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toFootprint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/* Output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">[Z object internals:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> OFFSET  SIZE      TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      0     4           (object header)                           01 00 00 00 (00000001 00000000 00000000 00000000) (1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      4     4           (object header)                           00 00 00 00 (00000000 00000000 00000000 00000000) (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      8     4           (object header)                           00 1b 00 00 (00000000 00011011 00000000 00000000) (6912)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     12     4           (object header)                           03 00 00 00 (00000011 00000000 00000000 00000000) (3)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     16     3   boolean [Z.&lt;elements&gt;                             N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     19     5           (loss due to the next object alignment)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Instance size: 24 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Space losses: 0 bytes internal + 5 bytes external = 5 bytes total</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="display:inline-block;color:rgb(98, 114, 164)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">[Z@1068e947d footprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     COUNT       AVG       SUM   DESCRIPTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1        24        24   [Z</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1                  24   (total)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Array intów</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> ints </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">ClassLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ints</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toPrintable</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">GraphLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">ints</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toFootprint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/* Output</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">[I object internals:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"> OFFSET  SIZE   TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      0     4        (object header)                           01 00 00 00 (00000001 00000000 00000000 00000000) (1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      4     4        (object header)                           00 00 00 00 (00000000 00000000 00000000 00000000) (0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">      8     4        (object header)                           a0 26 00 00 (10100000 00100110 00000000 00000000) (9888)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     12     4        (object header)                           04 00 00 00 (00000100 00000000 00000000 00000000) (4)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     16    16    int [I.&lt;elements&gt;                             N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Instance size: 32 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">Space losses: 0 bytes internal + 0 bytes external = 0 bytes total</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="display:inline-block;color:rgb(98, 114, 164)"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">[I@5f71c76ad footprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     COUNT       AVG       SUM   DESCRIPTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1        32        32   [I</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1                  32   (total)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pamięć-dla-arraylisty">Pamięć dla ArrayListy:<a class="hash-link" href="#pamięć-dla-arraylisty" title="Bezpośredni link do nagłówka">​</a></h3><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> integers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">GraphLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">integers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toFootprint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">java.util.ArrayList@185a6e9d footprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     COUNT       AVG       SUM   DESCRIPTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1        16        16   [Ljava.lang.Object;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1        24        24   java.util.ArrayList</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         2                  40   (total)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i</span><span class="token operator">&lt;</span><span class="token number">100000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i</span><span class="token operator">++</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            integers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">GraphLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">integers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toFootprint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">//output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">java.util.ArrayList@185a6e9d footprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     COUNT       AVG       SUM   DESCRIPTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1    426856    426856   [Ljava.lang.Object;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    100000        16   1600000   java.lang.Integer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1        24        24   java.util.ArrayList</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    100002             2026880   (total)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>2 026 880 bytes = 2mb 27kb dla 100 000 intów. (100 000 * 4=400 000 bytes.)
Gdy zainicjalizujemy initial capacity ArrayListy to wartość pamięci jest mniejsza o 26880 bytes (26kb)</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token generics class-name">Integer</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"> integers </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">new</span><span class="token plain"> </span><span class="token class-name">ArrayList</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token generics punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">100000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">GraphLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">integers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toFootprint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">java.util.ArrayList@179ece50d footprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     COUNT       AVG       SUM   DESCRIPTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1    400016    400016   [Ljava.lang.Object;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1        24        24   java.util.ArrayList</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         2              400040   (total)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i</span><span class="token operator">&lt;</span><span class="token number">100000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> i</span><span class="token operator">++</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            integers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">add</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token class-name">System</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">out</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">println</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token class-name">GraphLayout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">parseInstance</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">integers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">toFootprint</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">java.util.ArrayList@179ece50d footprint:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">     COUNT       AVG       SUM   DESCRIPTION</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1    400016    400016   [Ljava.lang.Object;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    100000        16   1600000   java.lang.Integer</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">         1        24        24   java.util.ArrayList</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">    100002             2000040   (total)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">*/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="boolean---przykład-układu-pamięci-klasy-osłonowej">Boolean - Przykład układu pamięci klasy osłonowej<a class="hash-link" href="#boolean---przykład-układu-pamięci-klasy-osłonowej" title="Bezpośredni link do nagłówka">​</a></h3><ul><li><p>Boolean 16 bytes - szczegóły układu pamięci poniżej:</p><p>Wywołujemy linię kodu: <code>System.*out*.println(ClassLayout.*parseClass*(Boolean.class).toPrintable());</code></p><p>Output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># WARNING: Unable to get Instrumentation. Dynamic Attach failed. You may add this JAR as -javaagent manually, or supply -Djdk.attach.allowAttachSelf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># WARNING: Unable to attach Serviceability Agent. sun.jvm.hotspot.memory.Universe.getNarrowOopBase()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">java.lang.Boolean object internals:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> OFFSET  SIZE      TYPE DESCRIPTION                               VALUE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      0    12           (object header)                           N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     12     1   boolean Boolean.value                             N/A</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     13     3           (loss due to the next object alignment)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Instance size: 16 bytes</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Space losses: 0 bytes internal + 3 bytes external = 3 bytes total</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Kopiuj do schowka" title="Kopiuj" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Wartość danych zajmuje 1 byte (8 bitów) a nie 1 bit jakby mogło się wydawać.
12 bytes na metadane + 1 byte na dane booleana + 3 bytes przesunięcia (aby była wielokrotność 8)=16bytów</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="string---obliczanie-pamięci-zajmowanej-przez-string---jol--footprint">String - <a href="/pl/blog/string-in-jvm-memory">Obliczanie pamięci zajmowanej przez String - JOL  Footprint</a><a class="hash-link" href="#string---obliczanie-pamięci-zajmowanej-przez-string---jol--footprint" title="Bezpośredni link do nagłówka">​</a></h3></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tagi:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pl/blog/tags/jvm">jvm</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pl/blog/tags/jol">jol</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pl/blog/tags/heap">heap</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pl/blog/tags/memory">memory</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/pl/blog/tags/references">references</a></li></ul></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Nawigacja na stronie postu na blogu"><a class="pagination-nav__link pagination-nav__link--next" href="/pl/blog/regular-expressions"><div class="pagination-nav__sublabel">Starszy post</div><div class="pagination-nav__label">Wyrażenia regularne</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#w-skrócie" class="table-of-contents__link toc-highlight">W skrócie</a></li><li><a href="#konfiguracja" class="table-of-contents__link toc-highlight">Konfiguracja</a></li><li><a href="#dostępne-metody" class="table-of-contents__link toc-highlight">Dostępne metody</a><ul><li><a href="#detale-vm---vmcurrentdetails---podstawowe-dane-związane-z-naszą-jvm" class="table-of-contents__link toc-highlight">Detale VM - <code>VM.current().details()</code> - Podstawowe dane związane z naszą JVM</a></li></ul></li><li><a href="#typy-określeń-zajmowanej-pamięci" class="table-of-contents__link toc-highlight">Typy określeń zajmowanej pamięci:</a><ul><li><a href="#układ-klasy---classlayout-shallow-size" class="table-of-contents__link toc-highlight">Układ klasy - ClassLayout (shallow size)</a></li><li><a href="#metadane" class="table-of-contents__link toc-highlight"><strong>Metadane:</strong></a></li><li><a href="#footprint-deep-size" class="table-of-contents__link toc-highlight">Footprint (Deep size)</a></li><li><a href="#compressed-vs-uncompressed-references" class="table-of-contents__link toc-highlight">Compressed vs Uncompressed References</a></li><li><a href="#powyżej-32-gb" class="table-of-contents__link toc-highlight">Powyżej 32 GB</a></li><li><a href="#co-to-jest-paddingalligment-gap-internal-space-losses" class="table-of-contents__link toc-highlight">Co to jest padding/alligment gap (internal space losses)</a></li><li><a href="#field-packing---upakowanie-pól" class="table-of-contents__link toc-highlight">Field Packing - Upakowanie pól</a></li></ul></li><li><a href="#inne-przykłady---sprawdzanie-rozmiaru-pamięci-dla-obiektów" class="table-of-contents__link toc-highlight">Inne przykłady - Sprawdzanie rozmiaru pamięci dla obiektów</a><ul><li><a href="#array" class="table-of-contents__link toc-highlight">Array:</a></li><li><a href="#pamięć-dla-arraylisty" class="table-of-contents__link toc-highlight">Pamięć dla ArrayListy:</a></li><li><a href="#boolean---przykład-układu-pamięci-klasy-osłonowej" class="table-of-contents__link toc-highlight">Boolean - Przykład układu pamięci klasy osłonowej</a></li><li><a href="#string---obliczanie-pamięci-zajmowanej-przez-string---jol--footprint" class="table-of-contents__link toc-highlight">String - Obliczanie pamięci zajmowanej przez String - JOL  Footprint</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">W skrócie</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pl/">Strona główna</a></li><li class="footer__item"><a class="footer__link-item" href="/pl/about">O mnie</a></li><li class="footer__item"><a class="footer__link-item" href="/pl/docs/projects">Projekty</a></li><li class="footer__item"><a class="footer__link-item" href="/pl/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Projekty</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/pl/docs/category/t8t---discord-tournaments">T8t - discord bot</a></li><li class="footer__item"><a class="footer__link-item" href="/pl/docs/camply">Camply</a></li></ul></div><div class="col footer__col"><div class="footer__title">Zewnętrzne linki</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto:jablonski.bartosz93@gmail.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Skontaktuj się przez Email<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/jablonski-bartosz93/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Linkedin<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitlab.com/bart_as93/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitlab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Bartosz Jabłoński</div></div></div></footer></div>
<script src="/pl/assets/js/runtime~main.4813a504.js"></script>
<script src="/pl/assets/js/main.b47291b4.js"></script>
</body>
</html>